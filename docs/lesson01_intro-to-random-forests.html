---

title: Lesson 1 - Introduction to random forests

keywords: fastai
sidebar: home_sidebar

summary: "A first look at training Random Forest models to identify τ → μμμ decays"
description: "A first look at training Random Forest models to identify τ → μμμ decays"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/lesson01_intro-to-random-forests.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://mybinder.org/v2/gh/lewtun/hepml/master?urlpath=lab/tree/notebooks%2Flesson01_intro-to-random-forests.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt="Binder"></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="References">References<a class="anchor-link" href="#References"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Chapter 3 of <em>Hands-On Machine Learning with Scikit-Learn and TensorFlow</em> by Aurèlien Geron</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-data">The data<a class="anchor-link" href="#The-data"> </a></h2><p>We will be analysing data from the Kaggle competition <a href="https://www.kaggle.com/c/flavours-of-physics/overview">Flavours of Physics: Finding τ → μμμ</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Import-libraries">Import libraries<a class="anchor-link" href="#Import-libraries"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># reload modules before executing user code</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="c1"># reload all modules every time before executing Python code</span>
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="c1"># render plots in notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># data wrangling</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">hepml.core</span> <span class="kn">import</span> <span class="n">display_large</span>

<span class="c1"># data viz</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">plot_roc_curve</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">color_codes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;muted&quot;</span><span class="p">))</span>

<span class="c1"># ml magic</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">hepml.evaluation</span> <span class="kn">import</span> <span class="n">roc_auc_truncated</span><span class="p">,</span> <span class="n">compute_ks</span><span class="p">,</span> <span class="n">compute_cvm</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-the-data">Load the data<a class="anchor-link" href="#Load-the-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DATA</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../data&quot;</span><span class="p">)</span>
<span class="o">!</span>ls <span class="o">{</span>DATA<span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>hb_submission.csv                tau_decays_test.csv
rf_submission.csv                tau_decays_train.csv
tau_decays_check_agreement.csv   training.csv
tau_decays_check_correlation.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATA</span> <span class="o">/</span> <span class="s2">&quot;tau_decays_train.csv&quot;</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATA</span> <span class="o">/</span> <span class="s2">&quot;tau_decays_test.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Inspect-the-data">Inspect the data<a class="anchor-link" href="#Inspect-the-data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Preview-the-data">Preview the data<a class="anchor-link" href="#Preview-the-data"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This first thing you should do after creating a <code>pandas.DataFrame</code> is to inspect the first/last few rows to make sure there's no surprises in the data format that need to be dealt with. For example, one often finds metadata or aggregations at the end of CSV/Excel files, and this can cause problems if not handled correctly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>DataFrame.head</code> method displays the <em>first</em> five rows of a <code>pandas.DataFrame</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>LifeTime</th>
      <th>dira</th>
      <th>FlightDistance</th>
      <th>FlightDistanceError</th>
      <th>IP</th>
      <th>IPSig</th>
      <th>VertexChi2</th>
      <th>pt</th>
      <th>DOCAone</th>
      <th>...</th>
      <th>p1_p</th>
      <th>p2_p</th>
      <th>p0_eta</th>
      <th>p1_eta</th>
      <th>p2_eta</th>
      <th>SPDhits</th>
      <th>production</th>
      <th>signal</th>
      <th>mass</th>
      <th>min_ANNmuon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18453471</td>
      <td>0.001578</td>
      <td>0.999999</td>
      <td>14.033335</td>
      <td>0.681401</td>
      <td>0.016039</td>
      <td>0.451886</td>
      <td>1.900433</td>
      <td>1482.037476</td>
      <td>0.066667</td>
      <td>...</td>
      <td>12290.760742</td>
      <td>39264.398438</td>
      <td>3.076006</td>
      <td>4.003800</td>
      <td>4.031514</td>
      <td>458</td>
      <td>-99</td>
      <td>0</td>
      <td>1866.300049</td>
      <td>0.277559</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5364094</td>
      <td>0.000988</td>
      <td>0.999705</td>
      <td>5.536157</td>
      <td>0.302341</td>
      <td>0.142163</td>
      <td>9.564503</td>
      <td>0.865666</td>
      <td>3050.720703</td>
      <td>0.024022</td>
      <td>...</td>
      <td>16562.667969</td>
      <td>7341.257812</td>
      <td>3.228553</td>
      <td>2.786543</td>
      <td>2.975564</td>
      <td>406</td>
      <td>-99</td>
      <td>0</td>
      <td>1727.095947</td>
      <td>0.225924</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11130990</td>
      <td>0.000877</td>
      <td>0.999984</td>
      <td>6.117302</td>
      <td>0.276463</td>
      <td>0.034746</td>
      <td>1.970751</td>
      <td>10.975849</td>
      <td>3895.908691</td>
      <td>0.055044</td>
      <td>...</td>
      <td>22695.388672</td>
      <td>10225.309570</td>
      <td>3.536903</td>
      <td>2.865686</td>
      <td>3.052810</td>
      <td>196</td>
      <td>-99</td>
      <td>0</td>
      <td>1898.588013</td>
      <td>0.368630</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15173787</td>
      <td>0.000854</td>
      <td>0.999903</td>
      <td>5.228067</td>
      <td>0.220739</td>
      <td>0.076389</td>
      <td>4.271331</td>
      <td>3.276358</td>
      <td>4010.781738</td>
      <td>0.053779</td>
      <td>...</td>
      <td>16909.515625</td>
      <td>9141.426758</td>
      <td>3.087461</td>
      <td>3.218034</td>
      <td>2.375592</td>
      <td>137</td>
      <td>-99</td>
      <td>0</td>
      <td>1840.410034</td>
      <td>0.246045</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1102544</td>
      <td>0.001129</td>
      <td>0.999995</td>
      <td>39.069534</td>
      <td>1.898197</td>
      <td>0.120936</td>
      <td>4.984982</td>
      <td>0.468348</td>
      <td>4144.546875</td>
      <td>0.004491</td>
      <td>...</td>
      <td>97612.804688</td>
      <td>47118.785156</td>
      <td>4.632295</td>
      <td>4.711155</td>
      <td>4.296878</td>
      <td>477</td>
      <td>-99</td>
      <td>0</td>
      <td>1899.793945</td>
      <td>0.222060</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 51 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we want to see more rows, we just pass an integer argument to the method as follows:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>LifeTime</th>
      <th>dira</th>
      <th>FlightDistance</th>
      <th>FlightDistanceError</th>
      <th>IP</th>
      <th>IPSig</th>
      <th>VertexChi2</th>
      <th>pt</th>
      <th>DOCAone</th>
      <th>...</th>
      <th>p1_p</th>
      <th>p2_p</th>
      <th>p0_eta</th>
      <th>p1_eta</th>
      <th>p2_eta</th>
      <th>SPDhits</th>
      <th>production</th>
      <th>signal</th>
      <th>mass</th>
      <th>min_ANNmuon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18453471</td>
      <td>0.001578</td>
      <td>0.999999</td>
      <td>14.033335</td>
      <td>0.681401</td>
      <td>0.016039</td>
      <td>0.451886</td>
      <td>1.900433</td>
      <td>1482.037476</td>
      <td>0.066667</td>
      <td>...</td>
      <td>12290.760742</td>
      <td>39264.398438</td>
      <td>3.076006</td>
      <td>4.003800</td>
      <td>4.031514</td>
      <td>458</td>
      <td>-99</td>
      <td>0</td>
      <td>1866.300049</td>
      <td>0.277559</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5364094</td>
      <td>0.000988</td>
      <td>0.999705</td>
      <td>5.536157</td>
      <td>0.302341</td>
      <td>0.142163</td>
      <td>9.564503</td>
      <td>0.865666</td>
      <td>3050.720703</td>
      <td>0.024022</td>
      <td>...</td>
      <td>16562.667969</td>
      <td>7341.257812</td>
      <td>3.228553</td>
      <td>2.786543</td>
      <td>2.975564</td>
      <td>406</td>
      <td>-99</td>
      <td>0</td>
      <td>1727.095947</td>
      <td>0.225924</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11130990</td>
      <td>0.000877</td>
      <td>0.999984</td>
      <td>6.117302</td>
      <td>0.276463</td>
      <td>0.034746</td>
      <td>1.970751</td>
      <td>10.975849</td>
      <td>3895.908691</td>
      <td>0.055044</td>
      <td>...</td>
      <td>22695.388672</td>
      <td>10225.309570</td>
      <td>3.536903</td>
      <td>2.865686</td>
      <td>3.052810</td>
      <td>196</td>
      <td>-99</td>
      <td>0</td>
      <td>1898.588013</td>
      <td>0.368630</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15173787</td>
      <td>0.000854</td>
      <td>0.999903</td>
      <td>5.228067</td>
      <td>0.220739</td>
      <td>0.076389</td>
      <td>4.271331</td>
      <td>3.276358</td>
      <td>4010.781738</td>
      <td>0.053779</td>
      <td>...</td>
      <td>16909.515625</td>
      <td>9141.426758</td>
      <td>3.087461</td>
      <td>3.218034</td>
      <td>2.375592</td>
      <td>137</td>
      <td>-99</td>
      <td>0</td>
      <td>1840.410034</td>
      <td>0.246045</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1102544</td>
      <td>0.001129</td>
      <td>0.999995</td>
      <td>39.069534</td>
      <td>1.898197</td>
      <td>0.120936</td>
      <td>4.984982</td>
      <td>0.468348</td>
      <td>4144.546875</td>
      <td>0.004491</td>
      <td>...</td>
      <td>97612.804688</td>
      <td>47118.785156</td>
      <td>4.632295</td>
      <td>4.711155</td>
      <td>4.296878</td>
      <td>477</td>
      <td>-99</td>
      <td>0</td>
      <td>1899.793945</td>
      <td>0.222060</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18316844</td>
      <td>0.000819</td>
      <td>0.995340</td>
      <td>3.638690</td>
      <td>0.250140</td>
      <td>0.232313</td>
      <td>12.628694</td>
      <td>13.217284</td>
      <td>1452.949585</td>
      <td>0.105752</td>
      <td>...</td>
      <td>12886.835938</td>
      <td>8040.938477</td>
      <td>3.673540</td>
      <td>3.150380</td>
      <td>2.974392</td>
      <td>258</td>
      <td>-99</td>
      <td>0</td>
      <td>1823.130981</td>
      <td>0.272359</td>
    </tr>
    <tr>
      <th>6</th>
      <td>16522942</td>
      <td>0.005190</td>
      <td>0.999985</td>
      <td>38.920113</td>
      <td>0.151273</td>
      <td>0.216020</td>
      <td>15.352684</td>
      <td>1.700249</td>
      <td>3912.482666</td>
      <td>0.006991</td>
      <td>...</td>
      <td>24599.054688</td>
      <td>10370.023438</td>
      <td>2.495311</td>
      <td>3.306201</td>
      <td>2.926639</td>
      <td>358</td>
      <td>-99</td>
      <td>0</td>
      <td>1665.762939</td>
      <td>0.229626</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3341177</td>
      <td>0.000632</td>
      <td>0.999601</td>
      <td>4.127854</td>
      <td>0.149296</td>
      <td>0.115681</td>
      <td>10.482354</td>
      <td>10.820628</td>
      <td>7682.583008</td>
      <td>0.052060</td>
      <td>...</td>
      <td>20122.953125</td>
      <td>8500.297852</td>
      <td>2.179665</td>
      <td>2.471615</td>
      <td>2.449492</td>
      <td>292</td>
      <td>-99</td>
      <td>0</td>
      <td>1930.380981</td>
      <td>0.370381</td>
    </tr>
    <tr>
      <th>8</th>
      <td>13870233</td>
      <td>0.001652</td>
      <td>0.999876</td>
      <td>11.274630</td>
      <td>0.320217</td>
      <td>0.177103</td>
      <td>8.269794</td>
      <td>3.301484</td>
      <td>3796.261719</td>
      <td>0.079522</td>
      <td>...</td>
      <td>10330.231445</td>
      <td>24728.355469</td>
      <td>3.445711</td>
      <td>2.545625</td>
      <td>3.273179</td>
      <td>222</td>
      <td>-99</td>
      <td>0</td>
      <td>1839.758057</td>
      <td>0.348409</td>
    </tr>
    <tr>
      <th>9</th>
      <td>17913585</td>
      <td>0.001048</td>
      <td>0.999771</td>
      <td>8.732768</td>
      <td>0.754453</td>
      <td>0.268545</td>
      <td>11.076645</td>
      <td>5.844945</td>
      <td>1901.681274</td>
      <td>0.041319</td>
      <td>...</td>
      <td>15422.355469</td>
      <td>25520.925781</td>
      <td>3.986849</td>
      <td>3.874437</td>
      <td>3.473346</td>
      <td>454</td>
      <td>-99</td>
      <td>0</td>
      <td>1809.005981</td>
      <td>0.269867</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 51 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similar to <code>DataFrame.head</code>, the <code>DataFrame.tail</code> method returns the <em>last</em> five rows of a <code>pandas.DataFrame</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>LifeTime</th>
      <th>dira</th>
      <th>FlightDistance</th>
      <th>FlightDistanceError</th>
      <th>IP</th>
      <th>IPSig</th>
      <th>VertexChi2</th>
      <th>pt</th>
      <th>DOCAone</th>
      <th>...</th>
      <th>p1_p</th>
      <th>p2_p</th>
      <th>p0_eta</th>
      <th>p1_eta</th>
      <th>p2_eta</th>
      <th>SPDhits</th>
      <th>production</th>
      <th>signal</th>
      <th>mass</th>
      <th>min_ANNmuon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>67548</th>
      <td>8697118</td>
      <td>0.002119</td>
      <td>0.999994</td>
      <td>13.959758</td>
      <td>0.218555</td>
      <td>0.048056</td>
      <td>4.228432</td>
      <td>2.259959</td>
      <td>4448.312500</td>
      <td>0.050823</td>
      <td>...</td>
      <td>21479.021484</td>
      <td>11186.428711</td>
      <td>3.243758</td>
      <td>2.662427</td>
      <td>2.909159</td>
      <td>236</td>
      <td>5</td>
      <td>1</td>
      <td>1778.930176</td>
      <td>0.613175</td>
    </tr>
    <tr>
      <th>67549</th>
      <td>16518324</td>
      <td>0.002150</td>
      <td>0.999994</td>
      <td>17.951668</td>
      <td>0.362415</td>
      <td>0.059266</td>
      <td>4.356027</td>
      <td>1.288439</td>
      <td>4094.758545</td>
      <td>0.027567</td>
      <td>...</td>
      <td>33156.484375</td>
      <td>7878.073730</td>
      <td>2.891281</td>
      <td>3.163634</td>
      <td>3.220385</td>
      <td>461</td>
      <td>1</td>
      <td>1</td>
      <td>1784.219360</td>
      <td>0.700559</td>
    </tr>
    <tr>
      <th>67550</th>
      <td>8826363</td>
      <td>0.000969</td>
      <td>0.999954</td>
      <td>5.089369</td>
      <td>0.250686</td>
      <td>0.051560</td>
      <td>2.790214</td>
      <td>1.725869</td>
      <td>2481.475830</td>
      <td>0.057835</td>
      <td>...</td>
      <td>11928.290039</td>
      <td>10929.805664</td>
      <td>3.189317</td>
      <td>3.259355</td>
      <td>2.774369</td>
      <td>125</td>
      <td>5</td>
      <td>1</td>
      <td>1781.661987</td>
      <td>0.316008</td>
    </tr>
    <tr>
      <th>67551</th>
      <td>13463112</td>
      <td>0.001296</td>
      <td>0.999996</td>
      <td>18.405382</td>
      <td>0.580693</td>
      <td>0.051905</td>
      <td>3.617818</td>
      <td>0.454716</td>
      <td>3977.924561</td>
      <td>0.035837</td>
      <td>...</td>
      <td>46318.148438</td>
      <td>24221.369141</td>
      <td>4.326723</td>
      <td>3.802581</td>
      <td>3.336862</td>
      <td>88</td>
      <td>1</td>
      <td>1</td>
      <td>1781.596558</td>
      <td>0.597442</td>
    </tr>
    <tr>
      <th>67552</th>
      <td>16716947</td>
      <td>0.000550</td>
      <td>0.999966</td>
      <td>3.726029</td>
      <td>0.281888</td>
      <td>0.031183</td>
      <td>2.172310</td>
      <td>3.116862</td>
      <td>3298.051025</td>
      <td>0.024616</td>
      <td>...</td>
      <td>17293.789062</td>
      <td>10099.850586</td>
      <td>3.095043</td>
      <td>3.226203</td>
      <td>2.850009</td>
      <td>137</td>
      <td>1</td>
      <td>1</td>
      <td>1772.682983</td>
      <td>0.602006</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 51 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One problem with the above previews is that the dataset has too many columns and <code>DataFrame.head</code> just shows <code>...</code> for intermediate columns. To fix that we can configure the <a href="https://pandas.pydata.org/pandas-docs/version/0.15/options.html">options in pandas</a> which we can wrap inside a simple function:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display_large</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>LifeTime</th>
      <th>dira</th>
      <th>FlightDistance</th>
      <th>FlightDistanceError</th>
      <th>IP</th>
      <th>IPSig</th>
      <th>VertexChi2</th>
      <th>pt</th>
      <th>DOCAone</th>
      <th>DOCAtwo</th>
      <th>DOCAthree</th>
      <th>IP_p0p2</th>
      <th>IP_p1p2</th>
      <th>isolationa</th>
      <th>isolationb</th>
      <th>isolationc</th>
      <th>isolationd</th>
      <th>isolatione</th>
      <th>isolationf</th>
      <th>iso</th>
      <th>CDF1</th>
      <th>CDF2</th>
      <th>CDF3</th>
      <th>ISO_SumBDT</th>
      <th>p0_IsoBDT</th>
      <th>p1_IsoBDT</th>
      <th>p2_IsoBDT</th>
      <th>p0_track_Chi2Dof</th>
      <th>p1_track_Chi2Dof</th>
      <th>p2_track_Chi2Dof</th>
      <th>p0_IP</th>
      <th>p1_IP</th>
      <th>p2_IP</th>
      <th>p0_IPSig</th>
      <th>p1_IPSig</th>
      <th>p2_IPSig</th>
      <th>p0_pt</th>
      <th>p1_pt</th>
      <th>p2_pt</th>
      <th>p0_p</th>
      <th>p1_p</th>
      <th>p2_p</th>
      <th>p0_eta</th>
      <th>p1_eta</th>
      <th>p2_eta</th>
      <th>SPDhits</th>
      <th>production</th>
      <th>signal</th>
      <th>mass</th>
      <th>min_ANNmuon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18453471</td>
      <td>0.001578</td>
      <td>0.999999</td>
      <td>14.033335</td>
      <td>0.681401</td>
      <td>0.016039</td>
      <td>0.451886</td>
      <td>1.900433</td>
      <td>1482.037476</td>
      <td>0.066667</td>
      <td>0.060602</td>
      <td>0.083660</td>
      <td>0.208855</td>
      <td>0.074343</td>
      <td>8</td>
      <td>5</td>
      <td>7</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>0.473952</td>
      <td>0.349447</td>
      <td>0.329157</td>
      <td>-0.579324</td>
      <td>-0.256309</td>
      <td>-0.215444</td>
      <td>-0.107570</td>
      <td>1.921700</td>
      <td>0.866657</td>
      <td>1.230708</td>
      <td>0.988054</td>
      <td>0.601483</td>
      <td>0.277090</td>
      <td>16.243183</td>
      <td>4.580875</td>
      <td>5.939936</td>
      <td>353.819733</td>
      <td>448.369446</td>
      <td>1393.246826</td>
      <td>3842.096436</td>
      <td>12290.760742</td>
      <td>39264.398438</td>
      <td>3.076006</td>
      <td>4.003800</td>
      <td>4.031514</td>
      <td>458</td>
      <td>-99</td>
      <td>0</td>
      <td>1866.300049</td>
      <td>0.277559</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5364094</td>
      <td>0.000988</td>
      <td>0.999705</td>
      <td>5.536157</td>
      <td>0.302341</td>
      <td>0.142163</td>
      <td>9.564503</td>
      <td>0.865666</td>
      <td>3050.720703</td>
      <td>0.024022</td>
      <td>0.019245</td>
      <td>0.030784</td>
      <td>0.336345</td>
      <td>0.173161</td>
      <td>7</td>
      <td>12</td>
      <td>2</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>0.325785</td>
      <td>0.265939</td>
      <td>0.192599</td>
      <td>-0.873926</td>
      <td>-0.223774</td>
      <td>-0.224871</td>
      <td>-0.425281</td>
      <td>0.958776</td>
      <td>0.858357</td>
      <td>1.810709</td>
      <td>0.098752</td>
      <td>0.219099</td>
      <td>0.614524</td>
      <td>3.610463</td>
      <td>15.555593</td>
      <td>11.238523</td>
      <td>656.524902</td>
      <td>2033.918701</td>
      <td>747.137024</td>
      <td>8299.368164</td>
      <td>16562.667969</td>
      <td>7341.257812</td>
      <td>3.228553</td>
      <td>2.786543</td>
      <td>2.975564</td>
      <td>406</td>
      <td>-99</td>
      <td>0</td>
      <td>1727.095947</td>
      <td>0.225924</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11130990</td>
      <td>0.000877</td>
      <td>0.999984</td>
      <td>6.117302</td>
      <td>0.276463</td>
      <td>0.034746</td>
      <td>1.970751</td>
      <td>10.975849</td>
      <td>3895.908691</td>
      <td>0.055044</td>
      <td>0.047947</td>
      <td>0.096829</td>
      <td>0.169165</td>
      <td>0.079789</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.786482</td>
      <td>0.557760</td>
      <td>-0.479636</td>
      <td>-0.202451</td>
      <td>-0.100762</td>
      <td>-0.176424</td>
      <td>0.720973</td>
      <td>1.408519</td>
      <td>1.038347</td>
      <td>0.186143</td>
      <td>0.215668</td>
      <td>0.371820</td>
      <td>4.851371</td>
      <td>11.590331</td>
      <td>13.723293</td>
      <td>658.523743</td>
      <td>2576.380615</td>
      <td>963.652466</td>
      <td>11323.134766</td>
      <td>22695.388672</td>
      <td>10225.309570</td>
      <td>3.536903</td>
      <td>2.865686</td>
      <td>3.052810</td>
      <td>196</td>
      <td>-99</td>
      <td>0</td>
      <td>1898.588013</td>
      <td>0.368630</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15173787</td>
      <td>0.000854</td>
      <td>0.999903</td>
      <td>5.228067</td>
      <td>0.220739</td>
      <td>0.076389</td>
      <td>4.271331</td>
      <td>3.276358</td>
      <td>4010.781738</td>
      <td>0.053779</td>
      <td>0.006417</td>
      <td>0.044816</td>
      <td>0.050989</td>
      <td>0.068167</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.501195</td>
      <td>0.501195</td>
      <td>-0.439453</td>
      <td>-0.162267</td>
      <td>-0.176424</td>
      <td>-0.100762</td>
      <td>1.172767</td>
      <td>2.044164</td>
      <td>0.811454</td>
      <td>0.255752</td>
      <td>0.210698</td>
      <td>0.392195</td>
      <td>7.292110</td>
      <td>8.778173</td>
      <td>16.462036</td>
      <td>1047.216187</td>
      <td>1351.734131</td>
      <td>1685.003662</td>
      <td>11502.081055</td>
      <td>16909.515625</td>
      <td>9141.426758</td>
      <td>3.087461</td>
      <td>3.218034</td>
      <td>2.375592</td>
      <td>137</td>
      <td>-99</td>
      <td>0</td>
      <td>1840.410034</td>
      <td>0.246045</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1102544</td>
      <td>0.001129</td>
      <td>0.999995</td>
      <td>39.069534</td>
      <td>1.898197</td>
      <td>0.120936</td>
      <td>4.984982</td>
      <td>0.468348</td>
      <td>4144.546875</td>
      <td>0.004491</td>
      <td>0.037326</td>
      <td>0.019026</td>
      <td>0.172065</td>
      <td>0.131732</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.639926</td>
      <td>-0.822285</td>
      <td>-0.291524</td>
      <td>-0.261078</td>
      <td>-0.269682</td>
      <td>1.523252</td>
      <td>0.435325</td>
      <td>0.581312</td>
      <td>0.270755</td>
      <td>0.183355</td>
      <td>0.630763</td>
      <td>6.783962</td>
      <td>3.342091</td>
      <td>17.252840</td>
      <td>1442.538208</td>
      <td>1755.792236</td>
      <td>1282.428711</td>
      <td>74117.117188</td>
      <td>97612.804688</td>
      <td>47118.785156</td>
      <td>4.632295</td>
      <td>4.711155</td>
      <td>4.296878</td>
      <td>477</td>
      <td>-99</td>
      <td>0</td>
      <td>1899.793945</td>
      <td>0.222060</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Alternatively, you can take the transpose to see all the columns more easily:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display_large</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>1.845347e+07</td>
      <td>5.364094e+06</td>
      <td>1.113099e+07</td>
      <td>1.517379e+07</td>
      <td>1.102544e+06</td>
    </tr>
    <tr>
      <th>LifeTime</th>
      <td>1.578324e-03</td>
      <td>9.880431e-04</td>
      <td>8.766738e-04</td>
      <td>8.541747e-04</td>
      <td>1.129335e-03</td>
    </tr>
    <tr>
      <th>dira</th>
      <td>9.999993e-01</td>
      <td>9.997048e-01</td>
      <td>9.999841e-01</td>
      <td>9.999029e-01</td>
      <td>9.999953e-01</td>
    </tr>
    <tr>
      <th>FlightDistance</th>
      <td>1.403333e+01</td>
      <td>5.536157e+00</td>
      <td>6.117302e+00</td>
      <td>5.228067e+00</td>
      <td>3.906953e+01</td>
    </tr>
    <tr>
      <th>FlightDistanceError</th>
      <td>6.814010e-01</td>
      <td>3.023407e-01</td>
      <td>2.764627e-01</td>
      <td>2.207391e-01</td>
      <td>1.898197e+00</td>
    </tr>
    <tr>
      <th>IP</th>
      <td>1.603948e-02</td>
      <td>1.421633e-01</td>
      <td>3.474572e-02</td>
      <td>7.638866e-02</td>
      <td>1.209356e-01</td>
    </tr>
    <tr>
      <th>IPSig</th>
      <td>4.518861e-01</td>
      <td>9.564503e+00</td>
      <td>1.970751e+00</td>
      <td>4.271331e+00</td>
      <td>4.984982e+00</td>
    </tr>
    <tr>
      <th>VertexChi2</th>
      <td>1.900433e+00</td>
      <td>8.656660e-01</td>
      <td>1.097585e+01</td>
      <td>3.276358e+00</td>
      <td>4.683484e-01</td>
    </tr>
    <tr>
      <th>pt</th>
      <td>1.482037e+03</td>
      <td>3.050721e+03</td>
      <td>3.895909e+03</td>
      <td>4.010782e+03</td>
      <td>4.144547e+03</td>
    </tr>
    <tr>
      <th>DOCAone</th>
      <td>6.666655e-02</td>
      <td>2.402188e-02</td>
      <td>5.504380e-02</td>
      <td>5.377948e-02</td>
      <td>4.491059e-03</td>
    </tr>
    <tr>
      <th>DOCAtwo</th>
      <td>6.060162e-02</td>
      <td>1.924494e-02</td>
      <td>4.794707e-02</td>
      <td>6.416951e-03</td>
      <td>3.732574e-02</td>
    </tr>
    <tr>
      <th>DOCAthree</th>
      <td>8.365952e-02</td>
      <td>3.078441e-02</td>
      <td>9.682913e-02</td>
      <td>4.481624e-02</td>
      <td>1.902647e-02</td>
    </tr>
    <tr>
      <th>IP_p0p2</th>
      <td>2.088553e-01</td>
      <td>3.363451e-01</td>
      <td>1.691652e-01</td>
      <td>5.098910e-02</td>
      <td>1.720649e-01</td>
    </tr>
    <tr>
      <th>IP_p1p2</th>
      <td>7.434290e-02</td>
      <td>1.731605e-01</td>
      <td>7.978933e-02</td>
      <td>6.816728e-02</td>
      <td>1.317325e-01</td>
    </tr>
    <tr>
      <th>isolationa</th>
      <td>8.000000e+00</td>
      <td>7.000000e+00</td>
      <td>1.000000e+00</td>
      <td>2.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>isolationb</th>
      <td>5.000000e+00</td>
      <td>1.200000e+01</td>
      <td>0.000000e+00</td>
      <td>2.000000e+00</td>
      <td>2.000000e+00</td>
    </tr>
    <tr>
      <th>isolationc</th>
      <td>7.000000e+00</td>
      <td>2.000000e+00</td>
      <td>1.000000e+00</td>
      <td>4.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>isolationd</th>
      <td>1.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>isolatione</th>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>isolationf</th>
      <td>3.000000e+00</td>
      <td>1.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>iso</th>
      <td>4.000000e+00</td>
      <td>2.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>CDF1</th>
      <td>4.739519e-01</td>
      <td>3.257854e-01</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>CDF2</th>
      <td>3.494466e-01</td>
      <td>2.659392e-01</td>
      <td>7.864819e-01</td>
      <td>5.011951e-01</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>CDF3</th>
      <td>3.291573e-01</td>
      <td>1.925992e-01</td>
      <td>5.577599e-01</td>
      <td>5.011951e-01</td>
      <td>6.399261e-01</td>
    </tr>
    <tr>
      <th>ISO_SumBDT</th>
      <td>-5.793236e-01</td>
      <td>-8.739262e-01</td>
      <td>-4.796365e-01</td>
      <td>-4.394529e-01</td>
      <td>-8.222846e-01</td>
    </tr>
    <tr>
      <th>p0_IsoBDT</th>
      <td>-2.563091e-01</td>
      <td>-2.237744e-01</td>
      <td>-2.024506e-01</td>
      <td>-1.622670e-01</td>
      <td>-2.915242e-01</td>
    </tr>
    <tr>
      <th>p1_IsoBDT</th>
      <td>-2.154442e-01</td>
      <td>-2.248709e-01</td>
      <td>-1.007623e-01</td>
      <td>-1.764236e-01</td>
      <td>-2.610783e-01</td>
    </tr>
    <tr>
      <th>p2_IsoBDT</th>
      <td>-1.075703e-01</td>
      <td>-4.252808e-01</td>
      <td>-1.764236e-01</td>
      <td>-1.007623e-01</td>
      <td>-2.696820e-01</td>
    </tr>
    <tr>
      <th>p0_track_Chi2Dof</th>
      <td>1.921700e+00</td>
      <td>9.587755e-01</td>
      <td>7.209732e-01</td>
      <td>1.172767e+00</td>
      <td>1.523252e+00</td>
    </tr>
    <tr>
      <th>p1_track_Chi2Dof</th>
      <td>8.666570e-01</td>
      <td>8.583573e-01</td>
      <td>1.408519e+00</td>
      <td>2.044164e+00</td>
      <td>4.353254e-01</td>
    </tr>
    <tr>
      <th>p2_track_Chi2Dof</th>
      <td>1.230708e+00</td>
      <td>1.810709e+00</td>
      <td>1.038347e+00</td>
      <td>8.114544e-01</td>
      <td>5.813122e-01</td>
    </tr>
    <tr>
      <th>p0_IP</th>
      <td>9.880540e-01</td>
      <td>9.875183e-02</td>
      <td>1.861427e-01</td>
      <td>2.557518e-01</td>
      <td>2.707552e-01</td>
    </tr>
    <tr>
      <th>p1_IP</th>
      <td>6.014826e-01</td>
      <td>2.190988e-01</td>
      <td>2.156678e-01</td>
      <td>2.106984e-01</td>
      <td>1.833549e-01</td>
    </tr>
    <tr>
      <th>p2_IP</th>
      <td>2.770898e-01</td>
      <td>6.145240e-01</td>
      <td>3.718195e-01</td>
      <td>3.921947e-01</td>
      <td>6.307629e-01</td>
    </tr>
    <tr>
      <th>p0_IPSig</th>
      <td>1.624318e+01</td>
      <td>3.610463e+00</td>
      <td>4.851371e+00</td>
      <td>7.292110e+00</td>
      <td>6.783962e+00</td>
    </tr>
    <tr>
      <th>p1_IPSig</th>
      <td>4.580875e+00</td>
      <td>1.555559e+01</td>
      <td>1.159033e+01</td>
      <td>8.778173e+00</td>
      <td>3.342091e+00</td>
    </tr>
    <tr>
      <th>p2_IPSig</th>
      <td>5.939936e+00</td>
      <td>1.123852e+01</td>
      <td>1.372329e+01</td>
      <td>1.646204e+01</td>
      <td>1.725284e+01</td>
    </tr>
    <tr>
      <th>p0_pt</th>
      <td>3.538197e+02</td>
      <td>6.565249e+02</td>
      <td>6.585237e+02</td>
      <td>1.047216e+03</td>
      <td>1.442538e+03</td>
    </tr>
    <tr>
      <th>p1_pt</th>
      <td>4.483694e+02</td>
      <td>2.033919e+03</td>
      <td>2.576381e+03</td>
      <td>1.351734e+03</td>
      <td>1.755792e+03</td>
    </tr>
    <tr>
      <th>p2_pt</th>
      <td>1.393247e+03</td>
      <td>7.471370e+02</td>
      <td>9.636525e+02</td>
      <td>1.685004e+03</td>
      <td>1.282429e+03</td>
    </tr>
    <tr>
      <th>p0_p</th>
      <td>3.842096e+03</td>
      <td>8.299368e+03</td>
      <td>1.132313e+04</td>
      <td>1.150208e+04</td>
      <td>7.411712e+04</td>
    </tr>
    <tr>
      <th>p1_p</th>
      <td>1.229076e+04</td>
      <td>1.656267e+04</td>
      <td>2.269539e+04</td>
      <td>1.690952e+04</td>
      <td>9.761280e+04</td>
    </tr>
    <tr>
      <th>p2_p</th>
      <td>3.926440e+04</td>
      <td>7.341258e+03</td>
      <td>1.022531e+04</td>
      <td>9.141427e+03</td>
      <td>4.711879e+04</td>
    </tr>
    <tr>
      <th>p0_eta</th>
      <td>3.076006e+00</td>
      <td>3.228553e+00</td>
      <td>3.536903e+00</td>
      <td>3.087461e+00</td>
      <td>4.632295e+00</td>
    </tr>
    <tr>
      <th>p1_eta</th>
      <td>4.003800e+00</td>
      <td>2.786543e+00</td>
      <td>2.865686e+00</td>
      <td>3.218034e+00</td>
      <td>4.711155e+00</td>
    </tr>
    <tr>
      <th>p2_eta</th>
      <td>4.031514e+00</td>
      <td>2.975564e+00</td>
      <td>3.052810e+00</td>
      <td>2.375592e+00</td>
      <td>4.296878e+00</td>
    </tr>
    <tr>
      <th>SPDhits</th>
      <td>4.580000e+02</td>
      <td>4.060000e+02</td>
      <td>1.960000e+02</td>
      <td>1.370000e+02</td>
      <td>4.770000e+02</td>
    </tr>
    <tr>
      <th>production</th>
      <td>-9.900000e+01</td>
      <td>-9.900000e+01</td>
      <td>-9.900000e+01</td>
      <td>-9.900000e+01</td>
      <td>-9.900000e+01</td>
    </tr>
    <tr>
      <th>signal</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>mass</th>
      <td>1.866300e+03</td>
      <td>1.727096e+03</td>
      <td>1.898588e+03</td>
      <td>1.840410e+03</td>
      <td>1.899794e+03</td>
    </tr>
    <tr>
      <th>min_ANNmuon</th>
      <td>2.775591e-01</td>
      <td>2.259240e-01</td>
      <td>3.686304e-01</td>
      <td>2.460451e-01</td>
      <td>2.220604e-01</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-shape-of-data">The shape of data<a class="anchor-link" href="#The-shape-of-data"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Whenever we have a new dataset it is handy to begin by getting an idea of how large the <code>DataFrame</code> is. This can be done with either the <code>len</code> or <code>DataFrame.shape</code> methods:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># get number of rows</span>
<span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(67553, 855819)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># get tuples of (n_rows, n_columns)</span>
<span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((67553, 51), (855819, 47))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Curiously, the test set has over 10 times more events than the training set 🤔. Looking at the data description on <a href="https://www.kaggle.com/c/flavours-of-physics/data">Kaggle</a> we see that the test set is actually composed of several types of events</p>
<blockquote><ul>
<li>simulated signal events for the τ → 3μ</li>
<li>real background data for the τ → 3μ</li>
<li>simulated events for the control channel, (ignored for scoring, used by agreement test)</li>
<li>real data for the control channel (ignored for scoring, used by agreement test)</li>
</ul>
</blockquote>
<p>which may explain the unusually large test set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Unique-values">Unique values<a class="anchor-link" href="#Unique-values"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Whenever we see an ID column like <code>id</code>, it is useful to perform a sanity check that each value is unique. Otherwise it may be possible that you have duplicates in your data that can bias your models and hence conclusions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span> <span class="n">test</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(67553, 855819)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Good! The number of unique IDs matches the number of rows in our train and test sets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Info">Info<a class="anchor-link" href="#Info"> </a></h3><p>The <code>DataFrame.info</code> method is useful to get a quick description of the data, in particular the total number of row, and each column's type and number of non-null values.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 67553 entries, 0 to 67552
Data columns (total 51 columns):
 #   Column               Non-Null Count  Dtype  
---  ------               --------------  -----  
 0   id                   67553 non-null  int64  
 1   LifeTime             67553 non-null  float64
 2   dira                 67553 non-null  float64
 3   FlightDistance       67553 non-null  float64
 4   FlightDistanceError  67553 non-null  float64
 5   IP                   67553 non-null  float64
 6   IPSig                67553 non-null  float64
 7   VertexChi2           67553 non-null  float64
 8   pt                   67553 non-null  float64
 9   DOCAone              67553 non-null  float64
 10  DOCAtwo              67553 non-null  float64
 11  DOCAthree            67553 non-null  float64
 12  IP_p0p2              67553 non-null  float64
 13  IP_p1p2              67553 non-null  float64
 14  isolationa           67553 non-null  int64  
 15  isolationb           67553 non-null  int64  
 16  isolationc           67553 non-null  int64  
 17  isolationd           67553 non-null  float64
 18  isolatione           67553 non-null  float64
 19  isolationf           67553 non-null  float64
 20  iso                  67553 non-null  float64
 21  CDF1                 67553 non-null  float64
 22  CDF2                 67553 non-null  float64
 23  CDF3                 67553 non-null  float64
 24  ISO_SumBDT           67553 non-null  float64
 25  p0_IsoBDT            67553 non-null  float64
 26  p1_IsoBDT            67553 non-null  float64
 27  p2_IsoBDT            67553 non-null  float64
 28  p0_track_Chi2Dof     67553 non-null  float64
 29  p1_track_Chi2Dof     67553 non-null  float64
 30  p2_track_Chi2Dof     67553 non-null  float64
 31  p0_IP                67553 non-null  float64
 32  p1_IP                67553 non-null  float64
 33  p2_IP                67553 non-null  float64
 34  p0_IPSig             67553 non-null  float64
 35  p1_IPSig             67553 non-null  float64
 36  p2_IPSig             67553 non-null  float64
 37  p0_pt                67553 non-null  float64
 38  p1_pt                67553 non-null  float64
 39  p2_pt                67553 non-null  float64
 40  p0_p                 67553 non-null  float64
 41  p1_p                 67553 non-null  float64
 42  p2_p                 67553 non-null  float64
 43  p0_eta               67553 non-null  float64
 44  p1_eta               67553 non-null  float64
 45  p2_eta               67553 non-null  float64
 46  SPDhits              67553 non-null  int64  
 47  production           67553 non-null  int64  
 48  signal               67553 non-null  int64  
 49  mass                 67553 non-null  float64
 50  min_ANNmuon          67553 non-null  float64
dtypes: float64(44), int64(7)
memory usage: 26.3 MB
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Luckily for us, it looks like we're dealing with purely numeric data types and there's no missing values 🥳🥳🥳! Let's verify the latter is indeed true:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">train</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="k">assert</span> <span class="n">test</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dropping-columns">Dropping columns<a class="anchor-link" href="#Dropping-columns"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As explained in the Kaggle <a href="https://www.kaggle.com/c/flavours-of-physics/data">docs</a></p>
<blockquote><p>The test dataset has all the columns that training.csv has, except mass, production, min_ANNmuon, and signal.</p>
</blockquote>
<p>so we need to remove these columns to prevent <a href="https://www.kaggle.com/dansbecker/data-leakage"><strong>data leakage</strong></a>, where a model is trained on features that are not present in the test data.</p>
<div style="text-align: center">
{% include image.html file="/hepml/images/data_leakage.png" %}
<p style="text-align: center;"> <b>Figure reference:</b> https://www.kaggle.com/dansbecker/data-leakage </p>
</div><p>One way to remove unwanted columns is via the <code>DataFrame.drop()</code> method, so let's remove these 3 columns from the training set, along with <code>SPDHits</code> which is described in the competition <a href="https://www.kaggle.com/c/flavours-of-physics/discussion">forum</a> as causing problems in the final evaluation:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols_to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mass&quot;</span><span class="p">,</span> <span class="s2">&quot;production&quot;</span><span class="p">,</span> <span class="s2">&quot;min_ANNmuon&quot;</span><span class="p">,</span> <span class="s2">&quot;SPDhits&quot;</span><span class="p">]</span>
<span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">cols_to_drop</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='You will often encounter the cryptic axis parameter when dealing with <code>pandas.DataFrame</code> and <code>pandas.Series</code> objects. This parameter is used to specify along which dimension we want to apply a given transformation - see the figure below for a graphical representation.' %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div style="text-align: center">
{% include image.html max-width="700" file="/hepml/./images/dataframe-series-axes.png" %}
<p style="text-align: center;"> <b>Figure:</b> Visualisation of the <code>axis</code> parameter in pandas. </p>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introducing-scikit-learn">Introducing scikit-learn<a class="anchor-link" href="#Introducing-scikit-learn"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we've checked that the training data is clean and free from obvious anomalies, it's time to train our model! To do so, we will make use of the scikit-learn library.</p>
<p>scikit-learn is one of the best known Python libraries for machine learning and provides efficient implementations of a large number of common algorithms. It has a uniform <em>Estimator API</em> as well as excellent online documentation. The main benefit of its API is that once you understand the basic use and syntax of scikit-learn for one type of model, switching to a new model or algorithm is very easy.</p>
<p><strong>Basics of the API</strong></p>
<p>The most common steps one takes when building a model in scikit-learn are:</p>
<ol>
<li>Choose a class of model by importing the appropriate estimator class from scikit-learn.</li>
<li>Choose model <em>hyperparameters</em> by instantiating this class with the desired values.</li>
<li>Arrange data into a feature matrix and target vector (see discussion below).</li>
<li>Fit the model to your data by calling the <code>fit()</code> method.</li>
<li>Evaluate the predictions of the model:<ul>
<li>For supervised learning we typically predict <em>labels</em> for new data using the <code>predict()</code> method.</li>
<li>For unsupervised learning, we often transform or infer properties of the data using the <code>transform()</code> or <code>predict()</code> methods.</li>
</ul>
</li>
</ol>
<p>Let's go through each of these steps to build a Random Forest regressor to predict California housing prices.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Choose-a-model">Choose a model<a class="anchor-link" href="#Choose-a-model"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In scikit-learn, every class of model is represented by a Python class. We want a Random Forest classifier, so looking at the online <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier">docs</a> we should import the <code>RandomForestClasifier</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Choose-hyperparameters">Choose hyperparameters<a class="anchor-link" href="#Choose-hyperparameters"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once we have chosen our model class, there are still some options open to us:</p>
<ul>
<li>What is the maximum depth of the tree? The default is <code>None</code> which means the nodes are expanded until all leaves are pure.</li>
<li>Other parameters can be found in the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier">docs</a>, but for now we take a simple model with just 20 trees.</li>
</ul>
<p>The above choices are often referred to as <em>hyperparameters</em> or parameters that must be set before the model is fit to the data. We can instantiate the <code>RandomForestClassifier</code> class and specify the desired hyperparameters as follows:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Arrange-data-into-a-feature-matrix-and-target-vector">Arrange data into a feature matrix and target vector<a class="anchor-link" href="#Arrange-data-into-a-feature-matrix-and-target-vector"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>scikit-learn requires that the data be arranged into a two-dimensional feature matrix and a one-dimensional target array. By convention:</p>
<ul>
<li>The feature matrix is often stored in a variable called <code>X</code>. This matrix is typically two-dimensional with shape <code>[n_samples, n_features]</code>, where <code>n_samples</code> refers to the number of rows (i.e. events in our case) and <code>n_features</code> refers to all columns except <code>signal</code> which is our target.</li>
<li>The target or label array is usually denoted by <code>y</code>.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;signal&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fit-the-model-to-your-data">Fit the model to your data<a class="anchor-link" href="#Fit-the-model-to-your-data"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now it is time to apply our model to data! This can be done with the <code>fit()</code> method:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, ccp_alpha=0.0, class_weight=None,
                       criterion=&#39;gini&#39;, max_depth=None, max_features=&#39;auto&#39;,
                       max_leaf_nodes=None, max_samples=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, n_estimators=20, n_jobs=-1,
                       oob_score=False, random_state=None, verbose=0,
                       warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Evaluate-the-predictions">Evaluate the predictions<a class="anchor-link" href="#Evaluate-the-predictions"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final step is to generate predictions and evaluate them against some performance metric:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9977055053069441</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wait, wat!? How can the Random Forest model have no error at all? Is this a perfect model? Of course it is much more likely that the model has badly overfit the data. To be sure we need to use part of the training set for training and part for model validation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include warning.html content='Evaluating our model&#8217;s predictions on the same data it was trained on is almost always a recipe for disaster! Why? The problem is that the model may memorise the structure of the data it sees and fail to provide good predictions when shown new data.' %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Better-evaluation-using-training-and-validation-splits">Better evaluation using training and validation splits<a class="anchor-link" href="#Better-evaluation-using-training-and-validation-splits"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One way to measure how well a model will generalise to new cases is to split your data into two sets: the <em><strong>training set</strong></em> and the <em><strong>validation set</strong></em>. As these names imply, you train your model using the training set and validate it using the validation set. The error rate on new cases is called the <em><strong>generalisation error</strong></em> and by evaluating your model on the validation set, you get an estimation of this error.</p>
<p>Creating a validation set is theoretically quite simple: just pick some instances randomly and set them aside (we set the random number generator's seed <code>random_state</code> so that is always generates the same shuffled indices):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset split: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="si">}</span><span class="s2"> train rows + </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span><span class="si">}</span><span class="s2"> valid rows&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Dataset split: 54042 train rows + 13511 valid rows
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Baseline-model">Baseline model<a class="anchor-link" href="#Baseline-model"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With these two datasets, we first fit on the training set and evaluate the prediction on the validation one. To simplify the evaluation of our models, let's write a simple function to keep track of the scores:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_scores</span><span class="p">(</span><span class="n">fitted_model</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Accuracy on train:&quot;</span><span class="p">:</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="n">y_train</span><span class="p">),</span>
        <span class="s2">&quot;ROC AUC on train:&quot;</span><span class="p">:</span> <span class="n">roc_auc_score</span><span class="p">(</span>
            <span class="n">y_train</span><span class="p">,</span> <span class="n">fitted_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="p">),</span>
        <span class="s2">&quot;Accuracy on valid:&quot;</span><span class="p">:</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">fitted_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">),</span> <span class="n">y_valid</span><span class="p">),</span>
        <span class="s2">&quot;ROC AUC on valid:&quot;</span><span class="p">:</span> <span class="n">roc_auc_score</span><span class="p">(</span>
            <span class="n">y_valid</span><span class="p">,</span> <span class="n">fitted_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="p">),</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fitted_model</span><span class="p">,</span> <span class="s2">&quot;oob_score_&quot;</span><span class="p">):</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;OOB accuracy:&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="o">.</span><span class="n">oob_score_</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, ccp_alpha=0.0, class_weight=None,
                       criterion=&#39;gini&#39;, max_depth=None, max_features=&#39;auto&#39;,
                       max_leaf_nodes=None, max_samples=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, n_estimators=20, n_jobs=-1,
                       oob_score=False, random_state=None, verbose=0,
                       warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_scores</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Accuracy on train: 0.998
ROC AUC on train: 1.0
Accuracy on valid: 0.855
ROC AUC on valid: 0.921
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ROC-Curves-and-AUC">ROC Curves and AUC<a class="anchor-link" href="#ROC-Curves-and-AUC"> </a></h2><p>Note that in addition to accuracy, we also show a second value, the <em><strong>Area Under the ROC Curve</strong></em> (AUC). The AUC is a good summary statistic of the predictiveness of a binary classifier. It varies from zero to one. A value of 0.5 corresponds to randomness (the classifier cannot distinguish at all between "signal" and "background") and a value of 1.0 means that it is perfect.</p>
<p>The "ROC" refers to the Receiver Operating Characteristic (ROC) curve which plots the <em>true positive rate</em></p>
<p>{{% raw %}}
$$ \mbox{TPR} = \frac{\mbox{TP}}{\mbox{TP} + \mbox{FP}} \,, \qquad \mbox{TP (FP)}  = \mbox{number of true (false) positives}\,,$$
{{% endraw %}}</p>
<p>against the <em>false positive rate</em> FPR, where the FPR is the ratio of negative instances that are incorrectly classified as positive. In general there is a tradeoff between these two quantities: the higher the TPR, the more false positives (FPR) the classifier produces. A good classifiers stays as close to the top-left corner of a ROC curve plot as possible.</p>
<p>In scikit-learn we can visualise the ROC curve of an estimator using the plotting API:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_roc_curve</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">roc_auc_truncated</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.912633624878523</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prepare-Kaggle-submission">Prepare Kaggle submission<a class="anchor-link" href="#Prepare-Kaggle-submission"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">check_agreement</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATA</span><span class="o">/</span><span class="s1">&#39;tau_decays_check_agreement.csv&#39;</span><span class="p">)</span>
<span class="n">check_correlation</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATA</span><span class="o">/</span><span class="s1">&#39;tau_decays_check_correlation.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols_to_keep</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agreement_probs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">check_agreement</span><span class="p">[</span><span class="n">cols_to_keep</span><span class="p">])[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Checking agreement...&quot;</span><span class="p">)</span>
<span class="n">ks</span> <span class="o">=</span> <span class="n">compute_ks</span><span class="p">(</span>
    <span class="n">agreement_probs</span><span class="p">[</span><span class="n">check_agreement</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">agreement_probs</span><span class="p">[</span><span class="n">check_agreement</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">check_agreement</span><span class="p">[</span><span class="n">check_agreement</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">check_agreement</span><span class="p">[</span><span class="n">check_agreement</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KS metric </span><span class="si">{</span><span class="n">ks</span><span class="si">:</span><span class="s2">.3</span><span class="si">}</span><span class="s2">,  </span><span class="si">{</span><span class="n">ks</span> <span class="o">&lt;</span> <span class="mf">0.09</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">correlation_probs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">check_correlation</span><span class="p">[</span><span class="n">cols_to_keep</span><span class="p">])[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Checking correlation...&quot;</span><span class="p">)</span>
<span class="n">cvm</span> <span class="o">=</span> <span class="n">compute_cvm</span><span class="p">(</span><span class="n">correlation_probs</span><span class="p">,</span> <span class="n">check_correlation</span><span class="p">[</span><span class="s2">&quot;mass&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CvM metric </span><span class="si">{</span><span class="n">cvm</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">cvm</span> <span class="o">&lt;</span> <span class="mf">0.002</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Checking agreement...
KS metric 0.0313,  True
Checking correlation...
CvM metric 0.002, True
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_probs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">cols_to_keep</span><span class="p">])[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">test</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="s2">&quot;prediction&quot;</span><span class="p">:</span> <span class="n">test_probs</span><span class="p">})</span>
<span class="n">submission</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">DATA</span><span class="o">/</span><span class="s2">&quot;rf_submission.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

